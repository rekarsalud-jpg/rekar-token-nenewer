name: ðŸ”„ Renovar Token Meta

on:
  schedule:
    # Cada 50 dÃ­as (aprox 7 semanas)
    - cron: "0 9 */50 * *"
  workflow_dispatch: # Permite correrlo manualmente tambiÃ©n

jobs:
  renew-token:
    runs-on: ubuntu-latest

    steps:
    - name: ðŸ§© Clonar repositorio
      uses: actions/checkout@v3

    - name: ðŸ Configurar Python
      uses: actions/setup-python@v4
      with:
        python-version: "3.10"

    - name: ðŸ“¦ Instalar dependencias
      run: |
        pip install requests

    - name: ðŸ” Ejecutar script de renovaciÃ³n
      run: python renew_token.py

    - name: ðŸ“¤ Subir token renovado
      uses: actions/upload-artifact@v3
      with:
        name: new_token
        path: new_token.txt

    - name: ðŸ“§ Enviar notificaciÃ³n por correo si falla
      if: failure()
      run: |
        echo "âš ï¸ Error al renovar token Meta." > message.txt
        echo "VerificÃ¡ el log del workflow." >> message.txt
        cat message.txt
